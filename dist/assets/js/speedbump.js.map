{"version":3,"sources":["speedbump.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"speedbump.js","sourcesContent":["/*!\n  * Speedbump v1.0.1\n*/\n\n$.fn.speedBumpModal = function (options) {\n\n    // Pass array through settings\n    var settings = $.extend({\n        'speedBumpTitle': 'You are leaving this website',\n        'speedBumpSummary': 'You are leaving our website and entering a third party website over which we have no control. We do not endorse or guarantee and are not responsible for the content, links, privacy, or security of the website, or the products, services, information, or recommendations offered on this website.',\n        'speedBumpContinueLink': 'Continue',\n        'speedBumpContinueLinkClass': '',\n        'speedBumpCancelLink': 'Cancel',\n        'speedBumpCancelClass': '',\n        'speedBumpIgnoreArray': [],\n        'speedBumpHeadingTag': '<h4>',\n        'speedBumpCloseButtonClass': '',\n        'speedBumpCloseIconClass': ''\n    }, options);\n\n    var continueClass = (settings.speedBumpContinueLinkClass !== '') ? settings.speedBumpContinueLinkClass : '';\n    var cancelClass = (settings.speedBumpCancelClass !== '') ? settings.speedBumpCancelClass : '';\n    var closeClass = (settings.speedBumpCloseButtonClass !== '') ? settings.speedBumpCloseButtonClass : '';\n\n    // Build outer speedbump modal div\n    $(document.createElement('div'))\n        .addClass('speed-bump')\n        .attr({\n            'tabindex': '-1',\n            'role': 'dialog',\n            'aria-modal': true,\n            'aria-labelledby': 'speedBumpTitle'\n        })\n        .appendTo('body');\n\n    // Build outer speed-bump dialog\n    $(document.createElement('div'))\n        .addClass('speed-bump__dialog')\n        .attr('role', 'document')\n        .appendTo('.speed-bump');\n\n    // Build speed-bump content\n    $(document.createElement('div'))\n        .addClass('speed-bump__content')\n        .appendTo('.speed-bump__dialog');\n\n    // Build speed-bump title\n    $(settings.speedBumpHeadingTag)\n        .addClass('speed-bump__title')\n        .attr('id', 'speedBumpTitle')\n        .html(settings.speedBumpTitle)\n        .appendTo('.speed-bump__content');\n\n    // Build speed-bump summary\n    $(document.createElement('p'))\n        .addClass('speed-bump__summary')\n        .html(settings.speedBumpSummary)\n        .appendTo('.speed-bump__content');\n\n    // Build speed-bump continue link\n    $(document.createElement('a'))\n        .addClass('speed-bump__continue')\n        .addClass(continueClass)\n        .attr('href', 'null')\n        .html(settings.speedBumpContinueLink)\n        .appendTo('.speed-bump__content');\n\n    // Build speed-bump cancel link\n    $(document.createElement('button'))\n        .addClass('speed-bump__cancel')\n        .addClass(cancelClass)\n        .attr({\n            'type': 'button'\n        })\n        .html(settings.speedBumpCancelLink)\n        .appendTo('.speed-bump__content');\n\n    // Build speed-bump close button\n    $(document.createElement('button'))\n        .addClass('speed-bump__close')\n        .addClass(closeClass)\n        .attr('type', 'button')\n        .attr('aria-label', 'Close')\n        .insertAfter('.speed-bump__title');\n\n    // Build speed-bump cancel button icon\n    if (settings.speedBumpCloseIconClass !== '') {\n        $(document.createElement('span'))\n            .addClass(settings.speedBumpCloseIconClass)\n            .attr('aria-hidden', 'true')\n            .appendTo('.speed-bump__close');\n    }\n\n    // Trap the keyboard to the off canvas elements when speedbump modal is showing\n    var focusBeforeSpeedbump;\n    var trapKeyboardToSpeedbump = function () {\n\n        // Cache anchor that fired speedbump\n        focusBeforeSpeedbump = $(':focus');\n\n        var firstTabbable = $('.speed-bump__close');\n        var lastTabbable = $('.speed-bump__cancel');\n\n        // Set focus on first input\n        firstTabbable.focus();\n\n        // Redirect last tab to first input\n        lastTabbable.on('keydown', function (e) {\n            if (e.which === 9 && !e.shiftKey) {\n                e.preventDefault();\n                firstTabbable.focus();\n            }\n        });\n\n        // Redirect first shift+tab to last input\n        firstTabbable.on('keydown', function (e) {\n            if (e.which === 9 && e.shiftKey) {\n                e.preventDefault();\n                lastTabbable.focus();\n            }\n        });\n\n        // Focus on the off canvas element\n        $('.speed-bump__content').focus();\n    };\n\n    // Close speed-bump function\n    function speedBumpHide() {\n        $('body').removeClass('js-speedbump-showing');\n        $('[data-anchor-active]')\n            .focus()\n            .removeAttr('data-anchor-active');\n        $('.speed-bump__continue').attr('target', '');\n        focusBeforeSpeedbump.focus();\n    }\n\n    // Setup array of domains to ignore\n    var flaggedArr = settings.speedBumpIgnoreArray;\n    var localUrl = location.host;\n    flaggedArr.push(localUrl);\n\n    var cleanArray = $.map(flaggedArr, function (n, i){\n        var arrayItem = n.split(' ').join('');\n        \n        if (arrayItem === '') {\n            return;\n        } else {\n            return arrayItem.toLowerCase();\n        }\n    });\n\n    function absolutePath(href) {\n        var link = document.createElement('a');\n        link.href = href;\n        return (link.protocol + '//' + link.host + link.pathname + link.search + link.hash);\n    }\n\n    // Set class on internal and ignored links\n    $('a[href]').each(function () {\n        var $this = $(this),\n            anchorHref = absolutePath($this.attr('href').toLowerCase());\n\n        for (var i = cleanArray.length - 1; i >= 0; --i) {\n            if (anchorHref.indexOf(cleanArray[i]) !== -1) {\n                $this.addClass('js-no-speed-bump');\n            }\n        }\n    });\n\n    var selectorString = \n        'a:not(.js-no-speed-bump)' +\n        ':not([href^=\"#\"])' +\n        ':not([href^=\"/\"])' +\n        ':not(.speed-bump__continue)' +\n        ':not([href=\"\"])'\n    ;\n\n    // Anchor click modal functionality\n    $(selectorString).on('click', function (e){\n        \n        $('body').addClass('js-speedbump-showing');\n\n        e.preventDefault();\n        e.stopPropagation();\n\n        var $this = $(this);\n        var $thisUrl = $this.attr('href');\n        var newWindow = ($this.attr('target') === '_blank') ? true : false;\n\n        // Add data attribute to currently active anchor\n        $this.attr('data-anchor-active', 'true');\n\n        // Display and focus on the speed-bump modal\n        $('.speed-bump')\n            .focus();\n\n        // Speedbump continue link\n        $('.speed-bump__continue').attr('href', $thisUrl);\n\n        if (newWindow === true) {\n            $('.speed-bump__continue').attr('target', '_blank');\n        }\n\n        trapKeyboardToSpeedbump();\n    });\n\n    // Speedbump cancel button click\n    $('.speed-bump__close, .speed-bump__cancel').on('click', function (e) {\n        speedBumpHide();\n    });\n\n    // Close speed bump after clicking continue\n    $('.speed-bump__continue').on('click', function () {\n        setTimeout(function (){\n            speedBumpHide();\n        }, 300);\n    });\n\n    // Click off speed-bump closes it\n    $('.speed-bump').on('click', function (e) {\n        if (!$(e.target).closest('.speed-bump__content').length) {\n            speedBumpHide();\n        }\n    }).on('keydown', function (e) {\n        if (e.keyCode === 27) {\n            speedBumpHide();\n        }\n    });\n};\n"]}